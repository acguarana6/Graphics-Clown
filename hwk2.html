<!-- This program

	CS 307
	HW 2: Clown
	Written by Peyton Wang and Alex Chin
	Due: March 5, 2021
-->

<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>HW 2: Clown Three.js Application</title>
	<style>
		canvas {
			display: block;
			margin: 30px;
			width: 70%;
			height: 400px;
		}
	</style>
	<script src="https://cs.wellesley.edu/~cs307/threejs/libs/three-r95.all.js">
		"https://cs.wellesley.edu/~cs307/threejs/libs/three-r80.min.js"
	</script>
	<script src="https://cs.wellesley.edu/~cs307/threejs/libs/OrbitControls-r95.js">
		"https://cs.wellesley.edu/~cs307/threejs/libs/OrbitControls-r80.js"
	</script>
	<script src="https://cs.wellesley.edu/~cs307/threejs/libs/dat.gui-r95.js">
		"https://cs.wellesley.edu/~cs307/threejs/libs/dat.gui-r80.min.js"
	</script>
	<script src="https://cs.wellesley.edu/~cs307/threejs/libs/tw-sp21.js">
		"https://cs.wellesley.edu/~cs307/threejs/libs/tw-fa18.js"
	</script>
</head>

<body>
	<h1>HW 2: Clown Three.js Application</h1>

	<script>
		// defining colors and materials for the clown
		var bodyColor = "dodgerblue";
		var headColor = "aquamarine";
		var eyesColor = "indigo"
		var legsColor = "magenta"
		var footColor = "green"
		
		var bodyMaterial = new THREE.MeshBasicMaterial({ color: bodyColor });
		var headMaterial = new THREE.MeshBasicMaterial({ color: headColor });
		var eyesMaterial = new THREE.MeshBasicMaterial({ color: eyesColor });
		var legsMaterial = new THREE.MeshBasicMaterial({ color: legsColor });
		var footMaterial = new THREE.MeshBasicMaterial({ color: footColor });

		function createNose(params) {
			var noseGeom = new THREE.SphereGeometry(params.noseRadius);
			var noseMesh = new THREE.Mesh(noseGeom, eyesMaterial);

			return noseMesh;
		}

		function addNose(head, params) {
			var noseframe = new THREE.Object3D();
			var nose = createNose(params);
			nose.position.z = params.headRadius;
			noseframe.add(nose);
			noseframe.rotation.x = params.noseRotation;
			head.add(noseframe);

			return head;
		}

		function createEar(params) {
			var earGeom = new THREE.SphereGeometry(params.earRadius);
			var earMesh = new THREE.Mesh(earGeom, eyesMaterial);
			earMesh.scale.z = params.earScale;

			return earMesh;
		}

		function addEar(head, params, side) {
			var earframe = new THREE.Object3D();
			var ear = createEar(params);
			var radius = params.headRadius;
			var angle = params.earAngle;
			ear.position.x = side * radius;
			earframe.rotation.z = side * angle;
			earframe.add(ear);
			head.add(earframe);

			return head;
		}

		function createEye(params) {
			var eyeGeom = new THREE.SphereGeometry(params.eyeRadius);
			var eyeMesh = new THREE.Mesh(eyeGeom, eyesMaterial);

			return eyeMesh;
		}

		function addEye(head, params, side) {
			var eyeframe = new THREE.Object3D();
			var eye = createEye(params);
			var radius = params.headRadius;
			eye.position.z = radius;
			eyeframe.rotation.x = params.eyeAngleX
			eyeframe.rotation.y = side * params.eyeAngleY;
			eyeframe.add(eye);
			head.add(eyeframe);

			return head;
		}

		function createMouth(params) {
			var mouthGeom = new THREE.TorusGeometry(params.mouthRadius, 0.2, 26, 100, -3.3);
			var mouthMesh = new THREE.Mesh(mouthGeom, legsMaterial);

			return mouthMesh;
		}

		function addMouth(head, params) {
			var mouthframe = new THREE.Object3D();
			var mouth = createMouth(params);
			mouth.position.z = params.headRadius + 0.2;
			mouthframe.add(mouth);
			mouthframe.rotation.x = params.mouthRotation;
			head.add(mouthframe);

			return head;
		}

		function createHead(params) {
			var head = new THREE.Object3D();
			var headGeom = new THREE.SphereGeometry(params.headRadius, 32, 32);
			var headMesh = new THREE.Mesh(headGeom, headMaterial);
			head.add(headMesh);
			
			addNose(head, params);
			addMouth(head, params);
			addEar(head, params, 1);
			addEar(head, params, -1);
			addEye(head, params, 1);
			addEye(head, params, -1);
			
			return head;
		}

		function createArm(params) {
			var arm = new THREE.Object3D();
			var armGeom = new THREE.CylinderGeometry(params.armRadiusTop, params.armRadiusBottom, params.armLength);
			var armMesh = new THREE.Mesh(armGeom, bodyMaterial);
			armMesh.position.y = -params.armLength / 2;
			arm.add(armMesh);
			
			return arm;
		}

		function addArm(clown, params, side) {
			var arm = createArm(params);
			var bodyRadius = params.bodyRadius;
			var scale = params.bodyScaleY;
			arm.position.set(side * params.shoulderWidth, params.shoulderHeight, 0);
			arm.rotation.z = side * Math.PI / 2;
			clown.add(arm);
		}

		function createLimb(radiusTop, radiusBottom, length, params) {
			var limb = new THREE.Object3D();
			var limbGeom = new THREE.CylinderGeometry(radiusTop, radiusBottom, length);
			var limbMesh = new THREE.Mesh(limbGeom, legsMaterial);
			limbMesh.position.y = -length / 2;
			limb.add(limbMesh);

			return limb;
		}

		function addLeg(clown, params, side) {
			var leg = createLimb(params.legRadiusTop, params.legRadiusBottom, params.legLength, params);
			leg.position.set(side * params.hipWidth, params.hipHeight, 0);
			clown.add(leg);
		}

		function createFoot(params) {
			var foot = new THREE.Object3D();
			var footGeom = new THREE.SphereGeometry(params.footRadius, 32, 32, 0, 6, 0, 1.5);
			var footMesh = new THREE.Mesh(footGeom, footMaterial);
			foot.add(footMesh);

			return footMesh;
		}

		function addFoot(leg, params, side) {
			var foot = createFoot(params);
			var hipWidth = side * params.hipWidth;
			var bodyLegLength = params.legLength*2 - 2.5;
			foot.position.set(hipWidth, -bodyLegLength, 0);
			leg.add(foot);
		}

		function createBody(params) {
			var body = new THREE.Object3D();
			var bodyGeom = new THREE.SphereGeometry(params.bodyRadius, 32, 32);
			var bodyMesh = new THREE.Mesh(bodyGeom, bodyMaterial);
			bodyMesh.scale.y = params.bodyScaleY;
			body.add(bodyMesh);

			addArm(body, params, 1);
			addArm(body, params, -1);
			addLeg(body, params, 1);
			addLeg(body, params, -1);
			addFoot(body, params, 1);
			addFoot(body, params, -1);

			return body;
		}

		function createClown(params) {
			var clown = new THREE.Object3D();
			var body = createBody(params);
			var head = createHead(params);
			var bodyHeight = params.bodyScaleY;
			var bodyRadius = params.bodyRadius;
			var headRadius = params.headRadius;
			head.position.y = bodyHeight * bodyRadius + headRadius - 0.5;
			
			clown.add(body);
			clown.add(head);
			
			return clown;
		}

		// ====================================================================

		var scene = new THREE.Scene();  // creates the scene

		// creating origin with yellow dot
		var originRadius = 0.5;
		var originGeom = new THREE.SphereGeometry(originRadius, 32, 32);
		var originMaterial = new THREE.MeshBasicMaterial({ color: "yellow", side: THREE.DoubleSide });
		var originMesh = new THREE.Mesh(originGeom, originMaterial);
		scene.add(originMesh);

		// creating and adding the clown to the scene
		var clownParams = {
			headRadius: 3.5,
			bodyRadius: 5,
			bodyScaleY: 1.5,

			noseRadius: 0.3,
			noseRotation: -0.01,

			earRadius: 1,
			earScale: 0.5,
			earAngle: 0.1,

			eyeRadius: 0.3,
			eyeAngleX: -0.2,
			eyeAngleY: 0.35,

			mouthRadius: 0.6,
			mouthRotation: 0.3,

			armLength: 7,
			armRadiusTop: 0.7,
			armRadiusBottom: 0.7,
			armRotation: 0.7,

			shoulderWidth: 2.5,
			shoulderHeight: 5.25,

			legLength: 9,
			legRadiusTop: 0.7,
			legRadiusBottom: 0.7,
			legRotation: 0.7,

			footRadius: 1,

			hipHeight: -6,
			hipWidth: 2.2
		}
		var clown = createClown(clownParams);
		scene.add(clown);
		clown.position.set(0, 15, 0);

		// ====================================================================

		// creates a renderer
		var renderer = new THREE.WebGLRenderer();

		TW.mainInit(renderer, scene);

		// uses a default orbiting camera
		TW.cameraSetup(renderer,
			scene,
			{
				minx: -10, maxx: 10,
				miny: -5, maxy: 40,
				minz: -10, maxz: 10
			}
		);
	</script>
</body>

</html>
